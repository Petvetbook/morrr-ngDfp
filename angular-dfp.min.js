"use strict";var googletag=googletag||{};googletag.cmd=googletag.cmd||[];var categoryExclusions={};angular.module("morrr-ngDfp",[]).constant("ngDfpUrl","//www.googletagservices.com/tag/js/gpt.js").provider("DoubleClick",["ngDfpUrl",function(e){var n={},t={},i={},o=null,r=!0,s=!0,a={},l=!1;this._createTag=function(n){if(s){var t=document.createElement("script"),i="https:"===document.location.protocol,o=document.getElementsByTagName("script")[0];t.async=!0,t.type="text/javascript",t.src=(i?"https:":"http:")+e,o.parentNode.insertBefore(t,o),t.onreadystatechange=function(){"complete"==this.readyState&&n()},t.onload=n}},this._initialize=function(){var e=this;googletag.cmd.push(function(){angular.forEach(n,function(e,n){t[n]=googletag.defineSlot.apply(null,e).addService(googletag.pubads()),i[n]&&t[n].defineSizeMapping(i[n]);var o=e.getSlotTargeting();o&&angular.forEach(o,function(e,i){t[n].setTargeting(e.id,e.value)})}),angular.forEach(a,function(e,n){googletag.pubads().setTargeting(n,e)}),l&&googletag.pubads().collapseEmptyDivs(),r&&googletag.pubads().enableSingleRequest(),googletag.enableServices(),googletag.pubads().addEventListener("slotRenderEnded",e._slotRenderEnded)})},this._slotRenderEnded=function(e){var t=n[e.slot.getSlotId().getDomId()].renderCallback;"function"==typeof t&&t()},this._refreshInterval=function(){return o},this.setRefreshInterval=function(e){return o=e,this},this.defineSlot=function(){var e=arguments;return e.getSize=function(){return this[1]},e.getSlotTargeting=function(){return this[3]?this[3]:!1},e.setRenderCallback=function(e){this.renderCallback=e},n[arguments[2]]=e,this},this.defineSizeMapping=function(){var e=arguments[0];return i[e]||(i[e]=[]),this.addSize=function(){return i[e].push([arguments[0],arguments[1]]),this},this},this.setSingleRequest=function(e){r=e},this.setEnabled=function(e){s=e},this.setPageTargeting=function(e,n){a[e]=n},this.collapseEmptyDivs=function(){l=!0};var g=this;this.$get=["$q","$window","$interval",function(e,i,o){var r=e.defer();return g._createTag(function(){g._initialize(),null!==g._refreshInterval()&&o(function(){googletag.cmd.push(function(){i.googletag.pubads().refresh()})},g._refreshInterval()),r.resolve()}),{getAdSize:function(e){return r.promise.then(function(){var t=n[e];if(angular.isUndefined(t))throw"Slot "+e+" has not been defined. Define it using DoubleClickProvider.defineSlot().";return n[e][1]})},getSlot:function(e){return r.promise.then(function(){var t=n[e];if(angular.isUndefined(t))throw"Slot "+e+" has not been defined. Define it using DoubleClickProvider.defineSlot().";return n[e]})},runAd:function(e){googletag.cmd.push(function(){t[e].displaying||(i.googletag.display(e),t[e].displaying=!0)})},refreshAds:function(){var e=[];angular.forEach(arguments,function(n){t&&t[n]&&t[n].displaying&&e.push(t[n]),Array.isArray(categoryExclusions[n])&&(0===categoryExclusions[n].length?t[n]&&t[n].clearCategoryExclusions():angular.forEach(categoryExclusions[n],function(e){t[n].setCategoryExclusion(e)}))}),googletag.cmd.push(function(){i.googletag.pubads().refresh(e)})}}}]}]).directive("ngDfpAdContainer",function(){return{restrict:"A",controller:["$element",function(e){function n(n){"visibility"===n?e.css("visibility","hidden"):e.hide()}function t(n){"visibility"===n?e.css("visibility","visible"):e.show()}this.$$setVisible=function(e,i){e?t(i):n(i)}}]}}).directive("ngDfpAd",["$timeout","$parse","$interval","DoubleClick",function(e,n,t,i){return{restrict:"A",template:'<div id="{{adId}}"></div>',require:"?^ngDfpAdContainer",scope:{adId:"@ngDfpAd",refresh:"@ngDfpAdRefresh",interval:"@ngDfpAdRefreshInterval",timeout:"@ngDfpAdRefreshTimeout",exclusions:"=ngDfpCategoryExclusions"},replace:!0,link:function(n,o,r,s){n.$watch("adId",function(a){o.html("");var l=null;i.getSlot(a).then(function(g){var u=g.getSize();n.exclusions&&n.exclusions.length>0?categoryExclusions[a]=n.exclusions:categoryExclusions[a]=[],o.css("width",u[0]).css("height",u[1]),e(function(){i.runAd(a)}),s&&g.setRenderCallback(function(){angular.isDefined(r.ngDfpAdHideWhenEmpty)&&(0===o.find("iframe:not([id*=hidden])").map(function(){return this.contentWindow.document}).find("body").children().length?s.$$setVisible(!1,r.ngDfpAdHideWhenEmpty):s.$$setVisible(!0,r.ngDfpAdHideWhenEmpty))}),n.$watch("refresh",function(e){angular.isUndefined(e)||i.refreshAds(a)}),n.$watch("interval",function(e){angular.isUndefined(e)||(t.cancel(l),l=t(function(){i.refreshAds(a)},n.interval))}),n.$watch("timeout",function(t){angular.isUndefined(t)||e(function(){i.refreshAds(a)},n.timeout)})})})}}}]);
